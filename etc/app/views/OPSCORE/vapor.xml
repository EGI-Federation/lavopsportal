<views xmlns="http://software.in2p3.fr/lavoisier/application.xsd" xmlns:xi="http://www.w3.org/2001/XInclude" >

    <!--

    !!!!!!!!! THIS FILE SHOULD BE USED ONLY IF VAPOR MODULE IS DEACTIVATED !!!!!!!!!!

    -->

    <view name="VAPOR_Endpoints_Policy">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('VAPOR_Endpoints_Policy.url')"/>
        </connector>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">43</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>
    </view>


    <view name="VAPOR_VO">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('VAPOR_VO.url')"/>
        </connector>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">43</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>
    </view>


    <view name="VAPOR_VoSites" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('vapor.vo.sites')"/>
        </connector>

        <processors>
            <element in="e:entries">
                <set variable="sites" index="@name">view('OPSCORE_prod_entities_certified')/NGIs/NGI/Sites/Site</set>

                <element in="e:entries">
                    <attribute-create out="email">find($sites,../@key)/@contact_email</attribute-create>
                </element>
            </element>
        </processors>
        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">33</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>
        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="VAPOR_biomed_sites_list" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('VAPOR.biomed.sites')"/>
        </connector>

        <processors>
            <element in="e:entries" out="sites">
                <element in="e:entries" out="site">
                    <element-ignore/>
                </element>
            </element>
        </processors>
        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="hours">6</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>
        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>


    <view name="VAPOR_biomed_sites">
        <connector type="XMLConnector">
            <parameter name="content" eval="view('OPSCORE_get_site')"/>
        </connector>
        <processors>
            <element in="results">
                <set variable="VAPOR_biomed_sites_list">view('VAPOR_biomed_sites_list')</set>
                <element-ignore in="SITE" if="not(@NAME=$VAPOR_biomed_sites_list/sites/site/@key)"/>
            </element>
        </processors>
    </view>


    <view name="VAPOR_biomed_endpoints">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('VAPOR.biomed.endpoints')"/>
        </connector>
        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="hours">4</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>
        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

</views>