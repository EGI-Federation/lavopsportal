<views xmlns="http://software.in2p3.fr/lavoisier/application.xsd" >

    <view name="spmt.services">
        <connector type="HTTPConnector">
            <parameter name="url">https://eosc-hub-devel.agora.grnet.gr/api/v2/services/</parameter>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">8</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>

    </view>

    <view name="marketplace.services" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="FileConnector">
            <parameter name="path">/app/resources/xml/listServices.xml</parameter>
        </connector>

        <processors>
            <element in="e:entries">
                <element in="e:entries">
                    <element-create>view('marketplace.services.provider',entry('providerId',../@id))</element-create>
                </element>
            </element>
            <element in="e:entries">
                <element in="e:entries">
                    <element-ignore in="e:entries">
                        <element in="e:entries">
                            <attribute-create out="key">../text()</attribute-create>
                        </element>

                    </element-ignore>
                </element>
            </element>

        </processors>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">28</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>


    </view>

    <view name="marketplace.services.provider" xmlns:html="http://www.w3.org/1999/xhtml" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="providerId"/>
        <connector type="HTTPConnector">
            <parameter name="url" eval="concat(property('marketplace.services'),$providerId)"/>
            <parameter name="certificate" eval="property('certificate.path')"/>
            <parameter name="passphrase" eval="property('certificate.password')"/>
            <parameter name="force-redirect">true</parameter>

        </connector>
        <serializer type="HTMLSerializer"/>

        <processors>
            <element in="html:html" out="e:entries" >
                <attribute-ignore/>
                    <element-ignore in="html:body">
                            <element-ignore in="html:main">
                                <elements-ignore path="html:div/html:div/html:div/html:div/html:div/html:div/html:div">
                                    <element in="html:h2" out="e:entries">
                                        <attribute-ignore/>
                                        <element-ignore in="html:a"><text/></element-ignore>
                                    </element>
                                </elements-ignore>
                            </element-ignore>
                    </element-ignore>
                    <element-ignore/>
            </element>
        </processors>


    </view>
    <view name="marketplace.providers" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('marketplace.api')"/>
            <parameter name="certificate" eval="property('certificate.path')"/>
            <parameter name="passphrase" eval="property('certificate.password')"/>
            <parameter name="force-redirect">true</parameter>

        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
        <element in="item" out="e:entries">
            <element in="object" out="e:entries">
                <attribute-create out="key">normalize-space(../SITENAME-SERVICEGROUP/text())</attribute-create>
                <element in="URL" out="e:entry"><attribute-create out="key">'url'</attribute-create></element>
                <element in="CONTACT_EMAIL" out="e:entry">
                    <attribute-create out="key">'email'</attribute-create>
                    <text-create>join(../item/text(),',')</text-create>
                    <element-ignore/>
                </element>
                <element-ignore/>
            </element>
        </element>

            <element in="e:entries">
                <element-ignore in="e:entries"></element-ignore>
                <element-create>sort_by_string(../e:entries,'@key')</element-create>
            </element>
    </processors>



        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',32,10)"/>
            </trigger>
        </cache>

        <pre-renderers>
            <row foreach="e:entries/e:entries">
                <column label="name">@key</column>
                <column label="email">e:entry[@key='email']/text()</column>
                <column label="url">e:entry[@key='url']/text()</column>
            </row>
        </pre-renderers>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
        
    </view>
    
    <view name="marketplace.providers.file" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="FileConnector">
            <parameter name="path">app/resources/json/services.json</parameter>
        </connector>
        <serializer type="JSONStreamSerializer"/>
        <processors>
            <element in="item" out="e:entries">
                <attribute-create out="fallback">true()</attribute-create>
                <element in="object" out="e:entries">
                    <attribute-create out="key">../SITENAME-SERVICEGROUP/text()</attribute-create>
                    <element in="URL" out="e:entry"><attribute-create out="key">'url'</attribute-create></element>
                    <element in="CONTACT_EMAIL" out="e:entry">
                        <attribute-create out="key">'email'</attribute-create>
                        <text-create>join(../item/text(),',')</text-create>
                       <element-ignore/>
                    </element>
                    <element-ignore/>
                </element>

            </element>
        </processors>
    </view>

    <view name="dpmt.providers" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="HTTPConnector">
            <parameter name="url">http://dp-api.eudat.eu/providers</parameter>
            <parameter name="header">
                <entry key="Content-Type">application/json</entry>
                <entry key="Accept">application/json</entry>
                <entry key="Authorization" eval="property('authentication.dpmt')"/>
            </parameter>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>

            <element in="object" out="e:entries">

                <element-ignore in="items">
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../title/text()</attribute-create>
                        <element in="description" out="e:entry">
                            <attribute-create out="key">'description'</attribute-create>
                        </element>
                        <element in="title" out="e:entry">
                            <attribute-create out="key">'NAME'</attribute-create>
                        </element>
                        <element in="review_state" out="e:entry">
                            <attribute-create out="key">'status'</attribute-create>
                        </element>
                        <element-create>entry('CONTACT_EMAIL','eudat@eudat.org')</element-create>
                        <element-ignore/>
                    </element>
                    <element-ignore/>
                </element-ignore>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <element-ignore in="e:entries"/>
                <element-create>sort_by_string(../e:entries,"e:entry[@key='NAME']")</element-create>
            </element>
        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',22,14)"/>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>


    <view name="JIRA_API_CALL_COMMENTS_EPIC">
        <argument name="start"/>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"  eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=comment,summary&amp;jql=project=',quot(property(concat('jira.project.',property('env')))),'AND ',quot('EOSC-hub TEST'),'=No',' AND issuetype=',quot('epic'),'&amp;startAt=',round($start),'&amp;maxResults=1000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>
    </view>


    <view name="JIRA_API_CALL_COMMENTS">
        <argument name="start"/>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"  eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=comment,summary&amp;jql=project=',quot(property(concat('jira.project.',property('env')))),'AND ',quot('EOSC-hub TEST'),'=No',' AND issuetype=',quot('Service Order'),'&amp;startAt=',round($start),'&amp;maxResults=1000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>
    </view>



    <view name="JiraComments">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_COMMENTS',entry('start',0))"></parameter>
        </connector>

        <processors>

        <element in="object">
            <element-create >view('JIRA_API_CALL_COMMENTS',entry('start',1000))/object/*</element-create>
        </element>

            <element in="object" out="issues">
                <element-ignore in="issues">
                    <element in="object" out="issue">
                        <attribute-create out="key">../key/text()</attribute-create>
                        <attribute-create out="nbComments">count(../fields/comment/comments/object)</attribute-create>
                        <element-ignore/>
                    </element>
                </element-ignore>
                <element-ignore></element-ignore>
            </element>
        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',18,8)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>
    <view name="JiraComments_egi">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_COMMENTS',entry('start',0)|entry('tenant','egi'))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_COMMENTS',entry('start',1000)|entry('tenant','egi'))/object/*</element-create>
            </element>

            <element in="object" out="issues">
                <element-ignore in="issues">
                    <element in="object" out="issue">
                        <attribute-create out="key">../key/text()</attribute-create>
                        <attribute-create out="nbComments">count(../fields/comment/comments/object)</attribute-create>
                        <element-ignore/>
                    </element>
                </element-ignore>
                <element-ignore></element-ignore>
            </element>
        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',16,6)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraCommentsEpic">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_COMMENTS_EPIC',entry('start',0))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_COMMENTS_EPIC',entry('start',1000))/object/*</element-create>
            </element>

            <element in="object" out="issues">
                <element-ignore in="issues">
                    <element in="object" out="issue">
                        <attribute-create out="key">../key/text()</attribute-create>
                        <attribute-create out="nbComments">count(../fields/comment/comments/object)</attribute-create>
                        <element-ignore/>
                    </element>
                </element-ignore>
                <element-ignore></element-ignore>
            </element>
        </processors>


        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',14,6)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraCommentsEpic_egi">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_COMMENTS_EPIC',entry('start',0)|entry('tenant','egi'))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_COMMENTS_EPIC',entry('start',1000)|entry('tenant','egi'))/object/*</element-create>
            </element>

            <element in="object" out="issues">
                <element-ignore in="issues">
                    <element in="object" out="issue">
                        <attribute-create out="key">../key/text()</attribute-create>
                        <attribute-create out="nbComments">count(../fields/comment/comments/object)</attribute-create>
                        <element-ignore/>
                    </element>
                </element-ignore>
                <element-ignore></element-ignore>
            </element>
        </processors>


        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',14,6)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="InternalComments" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="SQLConnector">
            <parameter name="driver">com.mysql.jdbc.Driver</parameter>
            <parameter name="url" eval="property('ROD.db.url')"/>
            <parameter name="username" eval="property('ROD.db.username')"/>
            <parameter name="password" eval="property('ROD.db.password')"/>
            <parameter name="query">
                <entry>SELECT count(id), idTicket  from sombo_internal_comment group by idTicket</entry>
            </parameter>
        </connector>

        <processors>
            <element in="result" out="issues">
                <element in="row" out="issue">
                    <attribute-create out="key">../idTicket/text()</attribute-create>
                    <attribute-create out="nbComments">../count_id_/text()</attribute-create>
                    <element-ignore/>
                </element>
            </element>
        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',15,3)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>



    <view name="JiraComment" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >

        <argument name="ticketId">EOSCSO-2</argument>
        <variable name="tenant">eosc</variable>

        <connector type="HTTPConnector">
            <parameter name="url"
                       eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/issue/',$ticketId,'/comment')"/>

        </connector>


        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="object" out="e:entries">
                <attribute-create out="key">'comments'</attribute-create>

                <element-ignore in="comments" >
                    <element-create>entry('NbComments',count(../object))</element-create>
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../created/text()</attribute-create>
                        <element-ignore in="author">
                            <element in="displayName" out="e:entry">
                                <attribute-create out="key">'author'</attribute-create>
                            </element>

                        </element-ignore>
                        <element in="created" out="e:entry">
                            <attribute-create out="key">'date'</attribute-create>
                        </element>
                        <element in="body" out="e:entry">
                            <attribute-create out="key">'body'</attribute-create>
                        </element>

                        <element-ignore/>
                    </element>
                </element-ignore>
                <element-ignore/>

            </element>

        </processors>

    </view>


    <view name="JiraServiceProvidersDate" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" xmlns:date="http://exslt.org/dates-and-times">
    <argument name="startDate"/>
    <argument name="endDate"/>

    <connector type="XMLConnector">
        <parameter name="content" eval="view('JiraServiceProviders')"/>
    </connector>

    <processors>


    <element in="e:entries">
            <element-ignore if="name()!='e:entries'"/>
            <element-ignore in="e:entries" if="date:seconds(date:difference(substring-before(e:entry[@key='created']/text(),'T'),$endDate)) + 86400 &lt;=0 or  date:seconds(date:difference($startDate,substring-before(e:entry[@key='created']/text(),'T'))) + 86400 &lt;=0">

            </element-ignore>

    </element>
    </processors>
    </view>

    <view name="JiraServiceProviders" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraServiceProvidersRaw',entry('tenant','eosc'))"></parameter>
        </connector>
        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',11,3)"/>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="JiraServiceProviders_egi" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraServiceProvidersRaw',entry('tenant','egi'))"></parameter>
        </connector>
        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',10,4)"/>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="JiraServiceProvidersRaw" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"     eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=assignee,status,created,updated,resolutiondate,customfield_10507,customfield_11600,customfield_10509&amp;jql=project=',quot(property('jira.sp')),'&amp;maxResults=5000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="object" out="e:entries">

                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../key/text()</attribute-create>

                        <element-ignore in="fields">

                            <element in="created" out="e:entry">
                                <attribute-create out="key">'created'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="updated" out="e:entry">
                                <attribute-create out="key">'updated'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="resolutiondate" out="e:entry">
                                <attribute-create out="key">'resolved'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>


                            <element in="assignee" out="e:entry">
                                <attribute-create out="key">'assignee'</attribute-create>
                                <element-ignore in="displayName"><text/></element-ignore>
                                <element-ignore/>
                                <text if=".='null'">'Unassigned'</text>
                            </element>



                        <element in="customfield_10507" out="e:entry">
                            <attribute-create out="key">'organisation'</attribute-create>
                        </element>

                        <element in="customfield_11600" out="e:entry">
                            <attribute-create out="key">'marketplace_url'</attribute-create>
                        </element>

                            <element in="customfield_10509" out="e:entry">
                                <attribute-create out="key" >'service_name'</attribute-create>
                            </element>



                        <element-ignore in="status">
                            <element in="name" out="e:entry">
                                <attribute-create out="key">'status'</attribute-create>
                            </element>

                        </element-ignore>

                            <element-ignore/>
                        </element-ignore>
                        <element-ignore/>
                </element>
                </element-ignore>
            </element>

        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraUsers" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraUsersRaw',entry('tenant','eosc'))"></parameter>
        </connector>
        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',16,5)"/>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="JiraUsers_egi" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraUsersRaw',entry('tenant','egi'))"></parameter>
        </connector>
        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',14,6)"/>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>


    <view name="JiraUsersRaw" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"    eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/user/assignable/search?project=',property(concat('jira.project.',property('env'))))" />
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="item" out="e:entries">
                <element-ignore>
                    <element in="name" out="e:entry">
                        <attribute-create out="key">../../displayName/text()</attribute-create>
                    </element>

                </element-ignore>

            </element>
        </processors>


        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>


    <view name="JiraSOListDate" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" xmlns:date="http://exslt.org/dates-and-times">
        <argument name="startDate"/>
        <argument name="endDate"/>
        <argument name="status">_status_</argument>

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraSOList')"/>
        </connector>

        <processors>

            <element in="e:entries" >
                <element in="e:entries">
                    <attribute-ignore in="count"/>
                    <element-ignore in="e:entries" if="date:seconds(date:difference(substring-before(e:entry[@key='created']/text(),'T'),$endDate)) + 86400 &lt;=0 or  date:seconds(date:difference($startDate,substring-before(e:entry[@key='created']/text(),'T'))) + 86400 &lt;=0">

                    </element-ignore>

                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-create out="count">count(../e:entries)</attribute-create>
                </element>
            </element>

            <element in="e:entries" if="$status!='_status_'">
                <element-ignore in="e:entries" if="@key!=$status"/>
            </element>

        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JIRA_API_CALL_SO">
        <argument name="start"/>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"  eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=assignee,status,created,updated,resolutiondate,customfield_10711,customfield_10223,customfield_10100,customfield_10254,customfield_10900,customfield_10400,customfield_11310&amp;jql=project=',quot(property(concat('jira.project.',property('env')))),'AND ',quot('EOSC-hub TEST'),'=No',' AND issuetype=',quot('Service Order'),'&amp;startAt=',round($start),'&amp;maxResults=1000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>
    </view>

    <view name="JiraSOListRaw" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_SO',entry('start',0))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_SO',entry('start',1000))/object/*</element-create>
            </element>

            <element in="object">
                <element-create >view('JIRA_API_CALL_SO',entry('start',2000))/object/*</element-create>
            </element>


            <element in="object" out="e:entries">
                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../key/text()</attribute-create>


                        <element-ignore in="fields">


                            <element in="created" out="e:entry">
                                <attribute-create out="key">'created'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="updated" out="e:entry">
                                <attribute-create out="key">'updated'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="resolutiondate" out="e:entry">
                                <attribute-create out="key">'resolved'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>


                            <element in="assignee" out="e:entry">
                                <attribute-create out="key">'assignee'</attribute-create>
                                <element-ignore in="displayName"><text/></element-ignore>
                                <element-ignore/>
                                <text if=".='null'">'Unassigned'</text>
                            </element>

                            <element in="customfield_10711" out="e:entry">
                                <attribute-create out="key">'SO-1'</attribute-create>
                            </element>

                            <element in="customfield_10400" out="e:entry">
                                <attribute-create out="key">'SO-1-legacy'</attribute-create>
                            </element>

                            <element in="customfield_10900" out="e:entry">
                                <attribute-create out="key">'SO-ServiceOrderTarget'</attribute-create>
                            </element>

                            <element in="customfield_10100" out="e:entry">
                                <attribute-create out="key">'EpicLink'</attribute-create>
                            </element>

                            <element in="customfield_10254" out="e:entry">
                                <attribute-create out="key">'Order Reference'</attribute-create>
                            </element>

                            <element in="customfield_10223" out="e:entry">
                                <attribute-create out="key">'AoDs Request status'</attribute-create>
                                <element-ignore in="value"><text></text></element-ignore>
                                <element-ignore/>
                            </element>


                            <element-ignore in="status">
                                <element in="name" out="e:entry">
                                    <attribute-create out="key">'status'</attribute-create>
                                </element>
                            </element-ignore>

                            <element-ignore/>
                        </element-ignore>
                        <element-ignore/>
                    </element>
                </element-ignore>
            </element>


            <element in="e:entries">
                <set variable="JiraEpicList" index="@key">view('JiraEpicList')/e:entries/e:entries</set>
                <set variable="JiraComments">view('JiraComments')/issues</set>
                <set variable="JiraCommentsEpic">view('JiraCommentsEpic')/issues</set>
                <set variable="InternalComments">view('InternalComments')/issues</set>
                <element in="e:entries">
                    <element-create>find($JiraEpicList,../e:entry[@key='EpicLink']/text())/*</element-create>
                    <element-create>entry('nbComments',new_text($JiraComments/issue[@key=current()/../@key]/@nbComments))</element-create>
                    <element-create>entry('nbCommentsEpic',new_text($JiraCommentsEpic/issue[@key=current()/../e:entry[@key='EpicLink']/text()]/@nbComments))</element-create>

                    <element-create if="$InternalComments/issue[@key=current()/../@key]/@nbComments">entry('nbNotes',new_text($InternalComments/issue[@key=current()/../@key]/@nbComments))</element-create>
                    <element-create if="not($InternalComments/issue[@key=current()/../@key]/@nbComments)">entry('nbNotes',0)</element-create>

                </element>
            </element>




        </processors>

    <cache type="FileCache">
        <trigger type="ViewNotifiedTrigger"/>
        <trigger type="DeltaTimeTrigger">
            <parameter name="minutes"  eval="choose(property('env')='test',12,3)"/>
        </trigger>

        <trigger type="DependencyRefreshedTrigger">
            <parameter name="views">
                <entry>JiraEpicList</entry>
                <entry>JiraComments</entry>
                <entry>JiraCommentsEpic</entry>
                <entry>InternalComments</entry>
            </parameter>
        </trigger>
    </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="JiraSOListRaw_egi" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_SO',entry('start',0)|entry('tenant','egi'))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_SO',entry('start',1000)|entry('tenant','egi'))/object/*</element-create>
            </element>

            <element in="object">
                <element-create >view('JIRA_API_CALL_SO',entry('start',2000)|entry('tenant','egi'))/object/*</element-create>
            </element>


            <element in="object" out="e:entries">
                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../key/text()</attribute-create>


                        <element-ignore in="fields">


                            <element in="created" out="e:entry">
                                <attribute-create out="key">'created'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="updated" out="e:entry">
                                <attribute-create out="key">'updated'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="resolutiondate" out="e:entry">
                                <attribute-create out="key">'resolved'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>


                            <element in="assignee" out="e:entry">
                                <attribute-create out="key">'assignee'</attribute-create>
                                <element-ignore in="displayName"><text/></element-ignore>
                                <element-ignore/>
                                <text if=".='null'">'Unassigned'</text>
                            </element>

                            <element in="customfield_10711" out="e:entry">
                                <attribute-create out="key">'SO-1'</attribute-create>
                            </element>

                            <element in="customfield_10400" out="e:entry">
                                <attribute-create out="key">'SO-1-legacy'</attribute-create>
                            </element>

                            <element in="customfield_10900" out="e:entry">
                                <attribute-create out="key">'SO-ServiceOrderTarget'</attribute-create>
                            </element>

                            <element in="customfield_10100" out="e:entry">
                                <attribute-create out="key">'EpicLink'</attribute-create>
                            </element>

                            <element in="customfield_10254" out="e:entry">
                                <attribute-create out="key">'Order Reference'</attribute-create>
                            </element>

                            <element in="customfield_10223" out="e:entry">
                                <attribute-create out="key">'AoDs Request status'</attribute-create>
                                <element-ignore in="value"><text></text></element-ignore>
                                <element-ignore/>
                            </element>


                            <element-ignore in="status">
                                <element in="name" out="e:entry">
                                    <attribute-create out="key">'status'</attribute-create>
                                </element>
                            </element-ignore>

                            <element-ignore/>
                        </element-ignore>
                        <element-ignore/>
                    </element>
                </element-ignore>
            </element>


            <element in="e:entries">
                <set variable="JiraEpicList" index="@key">view('JiraEpicList_egi')/e:entries/e:entries</set>
                <set variable="JiraComments">view('JiraComments_egi')/issues</set>
                <set variable="JiraCommentsEpic">view('JiraCommentsEpic_egi')/issues</set>
                <set variable="InternalComments">view('InternalComments')/issues</set>
                <element in="e:entries">
                    <element-create>find($JiraEpicList,../e:entry[@key='EpicLink']/text())/*</element-create>
                    <element-create>entry('nbComments',new_text($JiraComments/issue[@key=current()/../@key]/@nbComments))</element-create>
                    <element-create>entry('nbCommentsEpic',new_text($JiraCommentsEpic/issue[@key=current()/../e:entry[@key='EpicLink']/text()]/@nbComments))</element-create>

                    <element-create if="$InternalComments/issue[@key=current()/../@key]/@nbComments">entry('nbNotes',new_text($InternalComments/issue[@key=current()/../@key]/@nbComments))</element-create>
                    <element-create if="not($InternalComments/issue[@key=current()/../@key]/@nbComments)">entry('nbNotes',0)</element-create>

                </element>
            </element>




        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',12,3)"/>
            </trigger>

            <trigger type="DependencyRefreshedTrigger">
                <parameter name="views">
                    <entry>JiraEpicList</entry>
                    <entry>JiraComments</entry>
                    <entry>JiraCommentsEpic</entry>
                    <entry>InternalComments</entry>
                </parameter>
            </trigger>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="JiraSOList" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >

        <argument name="tenant">eosc</argument>

        <connector type="XMLConnector">
            <parameter name="content" eval="choose($tenant='eosc',view('JiraSOListRaw'),view('JiraSOListRaw_egi'))"/>
        </connector>

        <processors>
            <element in="e:entries">
                <element-ignore/>
                <element-create>sort_by_string(../e:entries,'e:entry[@key="status"]/text()')</element-create>
            </element>

            <element in="e:entries">
                <element-create-as-parent out="e:entries" attributes="new_attribute('key',e:entry[@key='status']/text())" group-by="e:entry[@key='status']/text()">
                    <element in="e:entries"/>
                </element-create-as-parent>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-create out="count">count(../e:entries)</attribute-create>
                    <element in="e:entries">
                        <element-create>entry('id',../@key)</element-create>
                    </element>
                </element>
            </element>

            <element in="e:entries">
                <element-ignore in="e:entries" if="@key='New'"/>
                <element-create as="first-child">../e:entries[@key='New']</element-create>
            </element>
        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraSOListFiltered" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >

        <!-- Argument : liste de statuts encadrés et séparés par des virgules -->
        <argument name="SOStatuses">_status_</argument>
        <argument name="EpicStatuses">_status_</argument>
        <argument name="tenant">eosc</argument>

        <connector type="XMLConnector">
            <parameter name="content" eval="choose($tenant='eosc',view('JiraSOListRaw'),view('JiraSOListRaw_egi'))"/>
        </connector>

        <processors>
            <element in="e:entries">
                <element in="e:entries">
                    <attribute-create out="parent">../e:entry[@key="EpicLink"]/text()</attribute-create>
                </element>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <element-ignore in="e:entries" if="e:entry[@key='Test']/text()='Yes'"/>
            </element>

            <element in="e:entries" if="$SOStatuses!='_status_'">
                <element-ignore in="e:entries" if="not(contains($SOStatuses,concat(',',e:entry[@key='status']/text(),',')))"/>
            </element>

            <element in="e:entries" if="$EpicStatuses!='_status_'">
                <element-ignore in="e:entries" if="not(contains($EpicStatuses,concat(',',e:entry[@key='Project status']/text(),',')))"/>
            </element>

            <element in="e:entries">
                <element-ignore in="e:entries"></element-ignore>
                <element-create>sort_by_string(../e:entries,'@parent')</element-create>
            </element>

            <element in="e:entries">
                <element-create-as-parent out="e:entries" group-by="@parent" attributes="@parent">
                    <element in="e:entries"/>
                </element-create-as-parent>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute in="parent" out="key"/>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <element in="e:entries">
                        <element in="e:entry" if="@key='SO-1' and text()='null'">
                            <text-ignore></text-ignore>
                            <text-create>../../e:entry[@key='SO-1-legacy']</text-create>
                        </element>
                    </element>
                </element>
            </element>



            <element in="e:entries">
                <element in="e:entries">
                    <element in="e:entries" if="starts-with(e:entry[@key='SO-1'],'{')">
                        <element-create>entry('service',substring-before(substring-after(../e:entry[@key="SO-1"],'"service":"'),'",'))</element-create>
                        <element-create>entry('category',substring-before(substring-after(../e:entry[@key="SO-1"],'"category":"'),'",'))</element-create>
                        <element-create>entry('offer',substring-before(substring-after(../e:entry[@key="SO-1"],'"offer":"'),'",'))</element-create>
                        <element-create>entry('attributes',substring-before(substring-after(../e:entry[@key="SO-1"],'"attributes":{'),'}'))</element-create>
                    </element>
                    <element in="e:entries" if="not(starts-with(e:entry[@key='SO-1'],'{'))">
                        <element-create>entry('category',substring-before(../e:entry[@key="SO-1"],'/'))</element-create>
                        <element-create>entry('service',substring-before(substring-after(../e:entry[@key="SO-1"],'/'),'/'))</element-create>
                        <element-create>entry('offer',substring-before(substring-after(substring-after(../e:entry[@key="SO-1"],'/'),'/'),'?'))</element-create>
                        <element-create>entry('attributes',substring-after(../e:entry[@key="SO-1"],'?'))</element-create>
                    </element>
                </element>
            </element>


            <element in="e:entries">
                <element-create as="first-child">
                    new_element('e:entries',new_attribute('key','nb_byStatus'))
                </element-create>
                <element-create as="first-child">
                    new_element('e:entries',new_attribute('key','nb_byStatus_Epic'))
                </element-create>
                <element-create as="first-child">
                    new_element('e:entries',new_attribute('key','nb_Epics')|new_text(count(/*/e:entries)))
                </element-create>
                <element-create as="first-child">
                    new_element('e:entries',new_attribute('key','nb_SO')|new_text(count(/*/*/e:entries)))
                </element-create>
            </element>

            <element in="e:entries">
                <element in="e:entries" if="@key='nb_byStatus'">
                    <element-create>/*/*/*/e:entry[@key='status']</element-create>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries" if="@key='nb_byStatus_Epic'">
                    <element-create>/*/*/*/e:entry[@key='Project status']</element-create>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries" if="@key='nb_byStatus' or @key='nb_byStatus_Epic'">
                    <element-ignore in="e:entry"></element-ignore>
                    <element-create>sort_by_string(../e:entry,'text()')</element-create>
                </element>
            </element>





            <element in="e:entries">
                <element in="e:entries" if="@key='nb_byStatus' or @key='nb_byStatus_Epic'">
                    <element-create-as-parent out="e:entry" attributes="new_attribute('key' , text())" group-by="text()">
                        <element in="e:entry"/>
                    </element-create-as-parent>
                </element>
            </element>




            <element in="e:entries">
                <element in="e:entries" if="@key='nb_byStatus' or @key='nb_byStatus_Epic'">
                    <element in="e:entry">
                        <text-create>count(../e:entry)</text-create>
                        <element-ignore/>
                    </element>
                </element>
            </element>


        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>



    <view name="JiraSOStats1" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" xmlns:str="http://exslt.org/strings" >

      <argument name="startDate">_start_</argument>
      <argument name="endDate">_end_</argument>

      <connector type="XMLConnector">
          <parameter name="content" eval="choose($startDate!='_start_',view('JiraSOListDate',entry('startDate',$startDate)|entry('endDate',$endDate)),view('JiraSOList'))"/>
      </connector>

      <processors>
          <element in="e:entries">
              <element-ignore in="e:entries">

                  <element in="e:entries">
                      <element in="e:entry" if="@key='created' or @key='SO-1' or @key='SO-1-legacy' or @key='status'"/>
                      <element-ignore/>
                  </element>
              </element-ignore>

          </element>

          <element in="e:entries">
              <element in="e:entries">
                  <element-ignore in="e:entry" if="@key='created'">
                      <element-create>entry('year',substring-before(current()/../text(),'-'))</element-create>
                      <element-create>entry('month',substring-before(substring-after(current()/../text(),'-'),'-'))</element-create>
                  </element-ignore>

                  <element-ignore in="e:entry" if="@key='SO-1'">
                      <text-ignore/>
                      <element-create if="starts-with(current()/../text(),'{')">entry('service',substring-before(substring-after(current()/../text(),'"service":"'),'","'))</element-create>
                      <element-create if="not(starts-with(current()/../text(),'{')) and count(current()/../text())=1">entry('service',substring-before(substring-after(current()/../text(),'/'),'/'))</element-create>
                      <element-create if="not(starts-with(current()/../text(),'{')) and count(current()/../text())&gt;1">entry('service',substring-before(substring-after(str:concat(current()/../text()),'/'),'/'))</element-create>

                  </element-ignore>

                  <element-ignore in="e:entry" if="@key='SO-1-legacy'">
                      <text-ignore/>
                      <element-create if="count(current()/../text())&gt;1" >entry('service2', substring-before(substring-after(str:concat(current()/../text()),'/'),'/'))</element-create>
                      <element-create if="count(current()/../text())=1" >entry('service2', substring-before(substring-after(current()/../text(),'/'),'/'))</element-create>
                  </element-ignore>

              </element>
          </element>

          <element in="e:entries">
              <element in="e:entries">
                  <element in="e:entry" if="@key='service' and text()=''">
                      <text-ignore/>
                      <text-create>../../e:entry[@key='service2']/text()</text-create>
                  </element>
              </element>
          </element>


          <element in="e:entries">
          <element in="e:entries">
              <element in="e:entry" if="@key='service'">
                  <text>upper-case(.)</text>
              </element>
          </element>
      </element>


          <element in="e:entries">
              <element in="e:entries">
                  <attribute-create out="id">concat(../e:entry[@key='service'],'___',../e:entry[@key='year'],'-',../e:entry[@key='month'])</attribute-create>
              </element>
          </element>

          <element in="e:entries">
              <element-ignore in="e:entries"/>
              <element-create>sort_by_string(../e:entries,'@id')</element-create>
          </element>

          <element in="e:entries">
              <element-create-as-parent out="e:entries" group-by="@id" attributes="@id">
                  <element in="e:entries"/>
              </element-create-as-parent>
          </element>

          <element in="e:entries">
              <element-create-as-parent out="e:entries" group-by="e:entries/e:entry[@key='service']/text()" >
                  <element in="e:entries"/>
              </element-create-as-parent>
          </element>

          <element in="e:entries">
              <element in="e:entries">
                  <attribute-create out="key">../e:entries/e:entries/e:entry[@key='service']/text()</attribute-create>
                  <element in="e:entries">
                      <attribute-ignore in="id"/>
                      <attribute-create out="key">substring-after(current()/../@id,'___')</attribute-create>
                      <element-create>entry('count',count(../e:entries))</element-create>
                      <element-create>entry('countApproved',count(../e:entries/e:entry[@key='status'][text()='Approved' or text()='Ready' or text()='Closed' ]))</element-create>
                      <element-create>entry('list',join(../e:entries/@key,','))</element-create>
                      <element-ignore/>
                  </element>
              </element>
          </element>

          <element in="e:entries">
              <element-ignore in="e:entries" if="@key=''">

              </element-ignore>
          </element>

          <element in="e:entries">
              <element in="e:entries">
                      <element-create as="last-child">
                          entries(entry('count',sum(../e:entries/e:entry[@key='count']))|entry('countApproved',sum(../e:entries/e:entry[@key='countApproved']))|entry('list',join(../e:entries/e:entry[@key='list'],',')))
                      </element-create>
              </element>
          </element>

          <element in="e:entries">
              <element in="e:entries">
                  <element in="e:entries" if="not(@key) and not(following-sibling::e:entries)">
                      <attribute-create out="key">'sum'</attribute-create>
                  </element>
              </element>
          </element>


      </processors>


      <renderers>
          <renderer type="DefaultRenderer">
              <parameter name="contentType">text/xml</parameter>
          </renderer>
      </renderers>
  </view>

    <view name="JiraSOFilteredbyDN" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
       <argument name="dn"/>
        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraSOList')"/>
        </connector>

        <processors>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-ignore in="count"></attribute-ignore>
                    <element in="e:entries">
                        <element-create>
                            entry('service',new_text(substring-before(substring-after(../e:entry[@key='SO-1']/text(),'"service":"'),'"')))
                        </element-create>
                    </element>
                </element>
            </element>

            <element in="e:entries">
                <set variable="services">view('ServicesAuthorized',entry('dn',$dn))</set>
                <element in="e:entries" if="not($services/result/row/service/text()='ALL')" >
                    <element-ignore in="e:entries" if="not($services/result/row/service/text()=e:entry[@key='service']/text())"/>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries" if="count(e:entries)!=0">
                    <attribute-create out="count">count(../e:entries)</attribute-create>
                </element>
                <element-ignore/>
            </element>

        </processors>

    </view>

    <view name="JiraSOFilteredbyID" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="id"/>
        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraSOList')"/>
        </connector>

        <processors>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-ignore in="count"></attribute-ignore>
                    <element in="e:entries">
                        <element-create>
                            entry('service',new_text(substring-before(substring-after(../e:entry[@key='SO-1']/text(),'"service":"'),'"')))
                        </element-create>
                    </element>
                </element>
            </element>

            <element in="e:entries">
                <set variable="services">view('ServicesAuthorized_Id',entry('id',$id))</set>
                <element in="e:entries" if="not($services/result/row/service/text()='ALL')" >
                    <element-ignore in="e:entries" if="not($services/result/row/service/text()=e:entry[@key='service']/text())"/>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries" if="count(e:entries)!=0">
                    <attribute-create out="count">count(../e:entries)</attribute-create>
                </element>
                <element-ignore/>
            </element>

        </processors>

    </view>

    <view name="ServicesAuthorized_Id">
        <argument name="id"/>
        <connector type="SQLConnector">
            <parameter name="driver">com.mysql.jdbc.Driver</parameter>
            <parameter name="url" eval="property('ROD.db.url')"/>
            <parameter name="username" eval="property('ROD.db.username')"/>
            <parameter name="password" eval="property('ROD.db.password')"/>
            <parameter name="query">
                <entry>SELECT sg.service  from sombo_groupe_ticket sg where sg.user_authorized=</entry>
                <entry eval="quot($id)"/>
            </parameter>
        </connector>
    </view>

    <view name="ServicesAuthorized">
        <argument name="dn"/>
        <connector type="SQLConnector">
            <parameter name="driver">com.mysql.jdbc.Driver</parameter>
            <parameter name="url" eval="property('ROD.db.url')"/>
            <parameter name="username" eval="property('ROD.db.username')"/>
            <parameter name="password" eval="property('ROD.db.password')"/>
            <parameter name="query">
                <entry>SELECT sg.service  from sombo_groupe_ticket sg, user u where sg.user_authorized=u.id and u.dn=</entry>
                <entry eval="quot($dn)"/>
            </parameter>
        </connector>
    </view>


    <view name="JiraEpicNotReferenced_egi" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >
        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraEpicList_egi')"/>
        </connector>

        <processors>
            <element in="e:entries">
                <set variable="JiraSOList">view('JiraSOList')</set>
                <attribute-create out="nbEntries">count(../e:entries)</attribute-create>
                <element in="e:entries" if="not(@key=$JiraSOList/e:entries/e:entries/e:entries/e:entry[@key='EpicLink']/text())"/>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <attribute-create out="nbEntriesOrphan">count(../e:entries)</attribute-create>
            </element>


        </processors>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">4</parameter>
                <parameter name="seconds">45</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraEpicNotReferenced" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >
        <connector type="XMLConnector">
            <parameter name="content" eval="view('JiraEpicList')"/>
        </connector>

        <processors>
            <element in="e:entries">
                <set variable="JiraSOList">view('JiraSOList')</set>
                <attribute-create out="nbEntries">count(../e:entries)</attribute-create>
                <element in="e:entries" if="not(@key=$JiraSOList/e:entries/e:entries/e:entries/e:entry[@key='EpicLink']/text())"/>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <attribute-create out="nbEntriesOrphan">count(../e:entries)</attribute-create>
            </element>


        </processors>

        <cache type="FileCache">
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes">4</parameter>
                <parameter name="seconds">45</parameter>
            </trigger>
            <trigger type="ViewNotifiedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JIRA_API_CALL_Epic">
        <argument name="start"/>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"       eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=created,updated,summary,status,customfield_10228,customfield_1010,customfield_11204,customfield_10706,customfield_11310&amp;jql=project=',quot(property(concat('jira.project.',property('env')))),' AND issuetype=',quot('epic'),'&amp;startAt=',round($start),'&amp;maxResults=1000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>
    </view>

    <view name="JIRA_API_ISSUE" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="id">EOSCSO-3263</argument>
        <argument name="type">epic</argument>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url" eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/issue/',$id)"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="object" out="issue">
                <set variable="listItems">choose($type='epic',view('JiraEpicFields'),view('JiraSOFields'))</set>
                <attribute-create out="key">../key/text()</attribute-create>

                <element-ignore in="fields">
                    <element  if="text()!='null'" out="e:entry">
                        <attribute-create out="key" if="starts-with(name(current()/..),'customfield_')">$listItems/items/item[@id=name(current()/..)]/@name</attribute-create>
                        <attribute-create out="key" if="not(starts-with(name(current()/..),'customfield_'))">name(..)</attribute-create>
                    </element>

                    <element if="not(text())" out="e:entry">
                        <attribute-create out="key" if="starts-with(name(current()/..),'customfield_')">$listItems/items/item[@id=name(current()/..)]/@name</attribute-create>
                        <attribute-create out="key" if="not(starts-with(name(current()/..),'customfield_'))">name(..)</attribute-create>
                        <text-create if="../value/text()">../value/text()</text-create>
                        <text-create if="not(../value/text()) and ../name/text()">../name/text()</text-create>
                        <element in="status" out="e:entry">
                            <attribute-create out="key">'status'</attribute-create>
                            <text-create>../statusCategory/name/text()</text-create>
                        </element>
                        <element-ignore/>
                    </element>

                </element-ignore>
            </element>

            <element in="issue" out="e:entries">
                <element-ignore in="e:entry" if="not(text())"/>
                <element-ignore in="e:entry" if="@key='attachment' or @key='workratio' or @key='Epic Color' or @key='Rank' or @key='fixVersions'"/>
            </element>
        </processors>
    </view>


    <view name="JiraEpicFields">
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"   eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/field?jql=project=',quot(property(concat('jira.project.',property('env')))),' AND issuetype=',quot('epic'))"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="item" out="items">
                <element in="object" out="item">
                    <attribute-create out="id">../id/text()</attribute-create>
                    <attribute-create out="name">../name/text()</attribute-create>
                    <element-ignore/>

                </element>

            </element>
        </processors>

    </view>

    <view name="JiraSOFields">
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"       eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/field?jql=project=',quot(property(concat('jira.project.',property('env')))),' AND issuetype=',quot('Service Order'))"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="item" out="items">
                <element in="object" out="item">
                    <attribute-create out="id">../id/text()</attribute-create>
                    <attribute-create out="name">../name/text()</attribute-create>
                    <element-ignore/>

                </element>

            </element>
        </processors>

    </view>

    <view name="JiraEpicList" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" >
        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_Epic',entry('start',0))"></parameter>
        </connector>

        <processors>

        <element in="object">
            <element-create >view('JIRA_API_CALL_Epic',entry('start',1000))/object/*</element-create>
        </element>

        <element in="object">
            <element-create >view('JIRA_API_CALL_Epic',entry('start',2000))/object/*</element-create>
        </element>



            <element in="object" out="e:entries">
                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <attribute-create out="key">../key/text()</attribute-create>
                        <element-ignore in="fields">

                            <element in="summary" out="e:entry">
                                <attribute-create out="key">'Project Summary'</attribute-create>
                            </element>


                            <element in="created" out="e:entry">
                                <attribute-create out="key">'createdEpic'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="updated" out="e:entry">
                                <attribute-create out="key">'updatedEpic'</attribute-create>
                                <text>substring(.,0,17)</text>
                            </element>

                            <element in="customfield_10228" out="e:entry">
                                <attribute-create out="key">'CI-DisplayName'</attribute-create>
                            </element>

                            <element in="customfield_11204" out="e:entry">
                                <attribute-create out="key">'Country'</attribute-create>
                                <elements-ignore path="/customfieldvalues/customfieldvalue"><text></text></elements-ignore>
                            </element>

                            <element in="customfield_10706" out="e:entry">
                                <attribute-create out="key">'Scientific Discipline'</attribute-create>
                                <elements-ignore path="/customfieldvalues/customfieldvalue"><text></text></elements-ignore>
                            </element>

                            <element in="customfield_11310" out="e:entry">
                                <attribute-create out="key">'Test'</attribute-create>
                                <element-ignore in="value"><text></text></element-ignore>
                                <element-ignore/>
                            </element>

                            <element-ignore in="status">
                                <element in="name" out="e:entry">
                                    <attribute-create out="key">'Project status'</attribute-create>
                                </element>
                            </element-ignore>

                            <element-ignore/>

                        </element-ignore>
                        <element-ignore/>
                    </element>
                </element-ignore>
            </element>



        </processors>

        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',12,5)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>
        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>


    </view>


    <view name="JIRA_API_CALL_HISTORY">
        <argument name="start"/>
        <argument name="tenant">eosc</argument>
        <connector type="HTTPConnector">
            <parameter name="url"  eval="concat('https://',property(concat('userJira_',$tenant)),':',property(concat('pwdJira_',$tenant)),'@',property(concat('instance_',$tenant)),'/rest/api/2/search?fields=status,created,updated,resolutiondate,customfield_10100&amp;expand=changelog&amp;jql=project=',quot(property(concat('jira.project.',property('env')))),'AND ',quot('EOSC-hub TEST'),'=No',' AND issuetype=',quot('Service Order'),'&amp;startAt=',round($start),'&amp;maxResults=1000')"/>
        </connector>
        <serializer type="JSONStreamSerializer"/>
    </view>

    <view name="JiraSO_History_egi" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" xmlns:date="http://exslt.org/dates-and-times" xmlns:str="http://exslt.org/strings">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_HISTORY',entry('start',0)|entry('tenant','egi'))"></parameter>
        </connector>

        <processors>

            <element in="object">
                <element-create >view('JIRA_API_CALL_HISTORY',entry('start',1000|entry('tenant','egi')))/object/*</element-create>
            </element>

            <element in="object">
                <element-create >view('JIRA_API_CALL_HISTORY',entry('start',2000|entry('tenant','egi')))/object/*</element-create>
            </element>

            <element in="object" out="e:entries">
                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <element-ignore in="fields">
                            <element in="status">
                                <element-ignore in="name">
                                    <text></text>
                                </element-ignore>
                                <element-ignore/>
                            </element>
                            <element in="customfield_10100" out="epicId"/>
                            <element in="created"></element>
                            <element in="updated"></element>
                            <element in="resolutiondate"/>
                        </element-ignore>
                        <element-ignore in="changelog">
                            <element-ignore in="histories">
                                <element in="object" out="history" if="items/object/field/text()='status'">
                                    <element in="created"></element>
                                    <element in="items"></element>
                                    <element-ignore/>
                                </element>
                            </element-ignore>
                        </element-ignore>
                    </element>
                </element-ignore>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <element in="history">
                        <element in="items">
                            <element in="object" if="field/text()='status'">
                                <element-ignore in="from"/>
                                <element-ignore in="to"/>
                                <element-ignore in="fieldtype"/>
                            </element>
                            <element-ignore/>
                        </element>
                    </element>
                    <element-ignore in="expand"/>
                    <element-ignore in="id"/>
                    <element-ignore in="self"/>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-create out="key">../key/text()</attribute-create>
                    <attribute-create out="epicId">../epicId/text()</attribute-create>
                    <attribute-create out="status">../status</attribute-create>
                    <attribute-create out="monthCreated">substring(../created/text(),0,8)</attribute-create>
                    <attribute-create out="monthResolved" if="../resolutiondate/text()!='null'">substring(../resolutiondate/text(),0,8)</attribute-create>
                    <attribute-create out="monthRejected" if="../history/items/object/toString/text()='Rejected'">substring(../history[items/object/toString/text()='Rejected']/created/text(),0,8)</attribute-create>
                    <attribute-create out="monthReadyness" if="../history/items/object/toString/text()='Ready'">substring(../history[items/object/toString/text()='Ready']/created/text(),0,8)</attribute-create>
                    <attribute-create out="responseTime" if="../history/items/object/fromString/text()='New'">
                        date:seconds(substring( ../history[items/object/fromString/text()='New']/created/text(),0,20))  -   date:seconds(substring(../created/text(),0,20))
                    </attribute-create>
                    <element-ignore/>
                </element>

            </element>
        </processors>


        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',11,8)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="JiraSO_History" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd" xmlns:date="http://exslt.org/dates-and-times" xmlns:str="http://exslt.org/strings">

        <connector type="XMLConnector">
            <parameter name="content" eval="view('JIRA_API_CALL_HISTORY',entry('start',0))"></parameter>
        </connector>

        <processors>

        <element in="object">
            <element-create >view('JIRA_API_CALL_HISTORY',entry('start',1000))/object/*</element-create>
        </element>

            <element in="object">
                <element-create >view('JIRA_API_CALL_HISTORY',entry('start',2000))/object/*</element-create>
            </element>

            <element in="object" out="e:entries">
                <element-ignore in="issues">
                    <element in="object" out="e:entries">
                        <element-ignore in="fields">
                            <element in="status">
                                <element-ignore in="name">
                                    <text></text>
                                </element-ignore>
                                <element-ignore/>
                            </element>
                            <element in="customfield_10100" out="epicId"/>
                            <element in="created"></element>
                            <element in="updated"></element>
                            <element in="resolutiondate"/>
                        </element-ignore>
                        <element-ignore in="changelog">
                            <element-ignore in="histories">
                                <element in="object" out="history" if="items/object/field/text()='status'">
                                    <element in="created"></element>
                                    <element in="items"></element>
                                    <element-ignore/>
                                </element>
                            </element-ignore>
                        </element-ignore>
                    </element>
                </element-ignore>
                <element-ignore/>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <element in="history">
                        <element in="items">
                            <element in="object" if="field/text()='status'">
                                <element-ignore in="from"/>
                                <element-ignore in="to"/>
                                <element-ignore in="fieldtype"/>
                            </element>
                            <element-ignore/>
                        </element>
                    </element>
                    <element-ignore in="expand"/>
                    <element-ignore in="id"/>
                    <element-ignore in="self"/>
                </element>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute-create out="key">../key/text()</attribute-create>
                    <attribute-create out="epicId">../epicId/text()</attribute-create>
                    <attribute-create out="status">../status</attribute-create>
                    <attribute-create out="monthCreated">substring(../created/text(),0,8)</attribute-create>
                    <attribute-create out="monthResolved" if="../resolutiondate/text()!='null'">substring(../resolutiondate/text(),0,8)</attribute-create>
                    <attribute-create out="monthRejected" if="../history/items/object/toString/text()='Rejected'">substring(../history[items/object/toString/text()='Rejected']/created/text(),0,8)</attribute-create>
                    <attribute-create out="monthReadyness" if="../history/items/object/toString/text()='Ready'">substring(../history[items/object/toString/text()='Ready']/created/text(),0,8)</attribute-create>
                    <attribute-create out="responseTime" if="../history/items/object/fromString/text()='New'">
                         date:seconds(substring( ../history[items/object/fromString/text()='New']/created/text(),0,20))  -   date:seconds(substring(../created/text(),0,20))
                    </attribute-create>
                    <element-ignore/>
                </element>

            </element>
        </processors>


        <cache type="FileCache">
            <trigger type="ViewNotifiedTrigger"/>
            <trigger type="DeltaTimeTrigger">
                <parameter name="minutes"  eval="choose(property('env')='test',12,7)"/>
            </trigger>
            <trigger type="ViewCreatedTrigger"/>
        </cache>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>


    <view name="jiraDisciplines" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <connector type="XMLConnector">
            <parameter name="content" eval="view('VoDisciplinesTree_Raw')"/>
        </connector>
        <processors>

            <element in="disciplines" out="e:entries">
                <element-ignore in="discipline">
                    <element in="discipline" out="e:entry">
                        <attribute in="value" out="key"/>
                        <attribute-ignore/>
                        <text-create>../@value</text-create>
                        <element-ignore/>

                    </element>
                </element-ignore>

            </element>

        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>

    <view name="SOCRM_KPI" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="tenant">eosc</argument>
        <connector type="XMLConnector">
            <parameter name="content" eval="choose($tenant='eosc',view('JiraSO_History'),view('JiraSO_History_egi'))"></parameter>
        </connector>

        <processors>

            <element in="e:entries">
                <element-ignore in="e:entries"></element-ignore>
                <element-create>sort_by_string(../e:entries,'@monthCreated')</element-create>
            </element>


            <element in="e:entries">
                <set variable="JiraEpicList" index="@key">choose($tenant='eosc',view('JiraEpicList')/e:entries/e:entries,view('JiraEpicList_egi')/e:entries/e:entries)</set>
                <set variable="JiraComments">choose($tenant='eosc',view('JiraComments')/issues,view('JiraComments_egi')/issues)</set>

                <element in="e:entries">
                        <attribute-create out="nbComments">$JiraComments/issue[@key=current()/../@key]/@nbComments</attribute-create>
                        <attribute-create out="test">find($JiraEpicList,current()/../@epicId)/e:entry[@key='Test']/text()</attribute-create>
                </element>
            </element>

<!--            <element in="e:entries">-->
<!--                <element-ignore in="e:entries" if="@test='Yes'"/>-->
<!--            </element>-->

            <element in="e:entries">
                <element-create-as-parent out="e:entries" group-by="@monthCreated" attributes="@monthCreated">
                    <element in="e:entries"/>
                </element-create-as-parent>
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <attribute in="monthCreated" out="key"></attribute>
                    <attribute-create out="Approved">count(../e:entries[@status='Approved'])</attribute-create>
                    <attribute-create out="Rejected">count(../e:entries[@status='Rejected'])</attribute-create>
                    <attribute-create out="Ready">count(../e:entries[@status='Ready'])</attribute-create>
                    <attribute-create out="In_progress">count(../e:entries[@status='In progress'])</attribute-create>
                    <attribute-create out="Waiting_for_respond">count(../e:entries[@status='Waiting for respond'])</attribute-create>
                    <attribute-create out="Total">count(../e:entries)</attribute-create>
                    <attribute-create out="Count">count(../e:entries)</attribute-create>
                    <attribute-create out="TotalwithComments">count(../e:entries[@nbComments>1 and @nbComments!='']) </attribute-create>
                    <attribute-create out="ResponseTimeMonth">sum(../e:entries[@test!='Yes']/@responseTime)</attribute-create>
                    <element-ignore/>
                </element>
            </element>
            
            <element in="e:entries">
                <element in="e:entries">
                    <attribute in="Approved">sum(../preceding-sibling::e:entries/@Approved) + .</attribute>
                    <attribute in="Rejected">sum(../preceding-sibling::e:entries/@Rejected) + .</attribute>
                    <attribute in="Ready">sum(../preceding-sibling::e:entries/@Ready) + .</attribute>
                    <attribute in="In_progress">sum(../preceding-sibling::e:entries/@In_progress) + .</attribute>
                    <attribute in="Waiting_for_respond">sum(../preceding-sibling::e:entries/@Waiting_for_respond) + .</attribute>
                    <attribute in="Total">sum(../preceding-sibling::e:entries/@Total) + .</attribute>
                    <attribute in="TotalwithComments">sum(../preceding-sibling::e:entries/@TotalwithComments) + .</attribute>
                    <attribute-create out="ResponseTime">sum(../preceding-sibling::e:entries/@ResponseTimeMonth) + ../@ResponseTimeMonth</attribute-create>
                </element>                
            </element>

            <element in="e:entries">
                <element in="e:entries">
                    <element-create>entry('Approved',../@Approved)</element-create>
                    <element-create>entry('Rejected',../@Rejected)</element-create>
                    <element-create>entry('Ready',../@Ready)</element-create>
                    <element-create>entry('In_progress',../@In_progress)</element-create>
                    <element-create>entry('Waiting_for_respond',../@Waiting_for_respond)</element-create>
                    <element-create>entry('Total',../@Total)</element-create>
                    <element-create>entry('Count',../@Count)</element-create>
                    <element-create>entry('TotalwithComments',../@TotalwithComments)</element-create>
                    <element-create>entry('ResponseTime',../@ResponseTime)</element-create>
                    <element-create>entry('ResponseTimeMonth',../@ResponseTimeMonth)</element-create>

                </element>
            </element>

        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>

    </view>

    <view name="eosc.api.providers">
        <connector type="HTTPConnector">
            <parameter name="url" eval="property('eosc.api.providers')"></parameter>
        </connector>
        <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="object" out="providers">
                <element-ignore in="results">
                    <element in="object" out="provider">
                        <attribute-create out="id">../id/text()</attribute-create>
                        <attribute-create out="name">../name/text()</attribute-create>
                        <attribute-create out="email">../publicContacts/object/email/text()</attribute-create>
                        <attribute-create out="url">../website/text()</attribute-create>
                        <element-ignore/>
                    </element>
                </element-ignore>

            </element>
        </processors>

        <pre-renderers>
            <row foreach="providers/provider">
                <column label="id">@id</column>
                <column label="name">@name</column>
                <column label="email">@email</column>
                <column label="url">@url</column>
            </row>
        </pre-renderers>
    </view>


    <view name="dpmt_push"  xmlns:java="http://software.in2p3.fr/lavoisier/java" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">
        <argument name="so"/>
        <argument name="key"/>
        <variable name="message" eval="java:encodeToString(java:java.util.Base64.getEncoder(), java:getBytes($so))"/>


        <connector type="HTTPConnector">

            <parameter name="url"
                       eval="concat('https://messaging-devel.argo.grnet.gr/v1/projects/ARGOTEST/topics/dpmt_test:publish?key=',property('ams.key'))"/>
            <parameter name="force-redirect">true</parameter>
            <parameter name="method">POST</parameter>
            <parameter name="header">
                <entry key="Content-Type">application/json</entry>
            </parameter>

            <parameter name="post" eval="concat('{', quot('messages'), ': [ {',quot('attributes'),': {',quot('key'),' : ',quot($key) , '},', quot('data'), ' : ',quot($message),'}]}')"/>

        </connector>
    <serializer type="JSONStreamSerializer"/>

        <processors>
            <element in="object" out="e:entries">
                <element in="messageIds" out="e:entry">
                    <attribute-create out="key">'message'</attribute-create>
                    <text-create>concat('Notification Item#', ../item/text(), ' successfully created')</text-create>
                    <element-ignore/>
                </element>
            </element>
        </processors>
</view>



<view name="dpmt_pull">
<connector type="HTTPConnector">
    <parameter name="url"
               eval="concat('https://messaging-devel.argo.grnet.gr/v1/projects/ARGOTEST/subscriptions/dpmt_test_sub:pull?key=',property('ams.key'))"/>
    <parameter name="force-redirect">true</parameter>
    <parameter name="method">POST</parameter>
    <parameter name="header">
        <entry key="Content-Type">application/json</entry>
    </parameter>
    <parameter name="post">{ "maxMessages": "10" }</parameter>

</connector>
<serializer type="JSONStreamSerializer"></serializer>
</view>


        </views>

