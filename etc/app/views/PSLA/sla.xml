<views xmlns="http://software.in2p3.fr/lavoisier/application.xsd" >

    <view name="JiraAPI" xmlns:e="http://software.in2p3.fr/lavoisier/entries.xsd">

        <connector type="HTTPConnector">
            <parameter name="url" eval="concat('https://',property('userJira'),':',property('pwdJira'),'@jira.eosc-hub.eu/rest/api/2/search?jql=issuetype=',quot('Service%20order'))"/>

        </connector>

       <serializer type="JSONStreamSerializer"/>


        <processors>


            <element in="object" out="e:entries">
                <set variable="translationJira">view('translationJira')</set>

                <element if="view('translationJira')/jiraItems/items[@in=local-name()] and not(view('translationJira')/jiraItems/items[@in=local-name()]/@out)"/>
                <element-ignore if="view('translationJira')/jiraItems/items[@in=local-name()] and  view('translationJira')/jiraItems/items[@in=local-name()]/@out">
                    <element-create>new_element(view('translationJira')/jiraItems/items[@in=local-name(..)]/@out,../text())</element-create>
                </element-ignore>

                <element-ignore/>

            </element>

            <element in="e:entries">

                <element-ignore if="not(*)">
                    <element-create>entry(local-name(..),choose(../text(),../text(),'NA'))</element-create>
                </element-ignore>


            <element in="e:entries">
                <element if="*" out="e:entries">
                    <attribute-create out="key">local-name(..)</attribute-create>

                    <element-ignore if="not(*)">
                        <element-create>entry(local-name(..),choose(../text(),../text(),'NA'))</element-create>
                    </element-ignore>

                </element>

                <element-ignore if="not(*)">
                    <element-create>entry(local-name(..),choose(../text(),../text(),'NA'))</element-create>
                </element-ignore>

            </element>

            </element>

        </processors>

        <renderers>
            <renderer type="DefaultRenderer">
                <parameter name="contentType">text/xml</parameter>
            </renderer>
        </renderers>
    </view>


    <view name="translationJira">
        <connector type="FileConnector">
                <parameter name="path">app/resources/xml/jiraEntries.xml</parameter>
        </connector>
    </view>

</views>

